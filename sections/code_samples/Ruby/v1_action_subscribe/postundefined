require 'uri'
require 'net/http'

url = URI("https://rest.zuora.com/v1/action/subscribe")

http = Net::HTTP.new(url.host, url.port)
http.use_ssl = true
http.verify_mode = OpenSSL::SSL::VERIFY_NONE

request = Net::HTTP::Post.new(url)
request["Authorization"] = 'Bearer 6d151216ef504f65b8ff6e9e9e8356d3'
request["content-type"] = 'application/json'
request.body = "{\n    \"subscribes\": [\n        {\n            \"Account\": {\n                \"AccountNumber\": \"A00000085\",\n                \"AutoPay\": false,\n                \"Batch\": \"Batch1\",\n                \"BillCycleDay\": 1,\n                \"Currency\": \"USD\",\n                \"Name\": \"West Corporation\",\n                \"PaymentTerm\": \"Due Upon Receipt\"\n            },\n            \"BillToContact\": {\n                \"Address1\": \"312 2nd Ave W\",\n                \"City\": \"Seattle\",\n                \"Country\": \"United States\",\n                \"FirstName\": \"Sarah\",\n                \"LastName\": \"Smith\",\n                \"PostalCode\": \"98119\",\n                \"State\": \"Washington\",\n                \"WorkEmail\": \"sarah@example.com\"\n            },\n            \"PaymentMethod\": {\n                \"CreditCardAddress1\": \"312 2nd Ave W\",\n                \"CreditCardCity\": \"Seattle\",\n                \"CreditCardCountry\": \"United States\",\n                \"CreditCardExpirationMonth\": 12,\n                \"CreditCardExpirationYear\": 2020,\n                \"CreditCardHolderName\": \"Ms Sarah Smith\",\n                \"CreditCardNumber\": \"4111111111111111\",\n                \"CreditCardPostalCode\": \"98119\",\n                \"CreditCardState\": \"Washington\",\n                \"CreditCardType\": \"Visa\",\n                \"Type\": \"CreditCard\"\n            },\n            \"SubscribeOptions\": {\n                \"GenerateInvoice\": true,\n                \"ProcessPayments\": false\n            },\n            \"SubscriptionData\": {\n                \"RatePlanData\": [\n                    {\n                        \"RatePlan\": {\n                            \"ProductRatePlanId\": \"2c92c0f966537bf001666218919620cc\"\n                        },\n                        \"RatePlanChargeData\": [\n                            {\n                                \"RatePlanCharge\": {\n                                    \"ChargeModel\": \"Discount-Percentage\",\n                                    \"DiscountPercentage\": \"6.75\",\n                                    \"ProductRatePlanChargeId\": \"2c92c0f866536da301666222643809b4\",\n                                    \"Quantity\": 200\n                                }\n                            }\n                        ]\n                    }\n                ],\n                \"Subscription\": {\n                    \"AutoRenew\": true,\n                    \"ContractAcceptanceDate\": \"2019-02-15\",\n                    \"ContractEffectiveDate\": \"2019-02-15\",\n                    \"InitialTerm\": 12,\n                    \"RenewalTerm\": 6,\n                    \"ServiceActivationDate\": \"2019-02-15\",\n                    \"TermType\": \"TERMED\"\n                }\n            }\n        }\n    ]\n}"

response = http.request(request)
puts response.read_body